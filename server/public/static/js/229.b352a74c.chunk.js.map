{"version":3,"file":"static/js/229.b352a74c.chunk.js","mappings":"yVAgBAA,EAAAA,EAAAA,iBAAmC,MAAOC,EAAAA,GAC1CD,EAAAA,EAAAA,iBAAmC,MAAOE,EAAAA,GAC1CF,EAAAA,EAAAA,iBAAmC,KAAMG,EAAAA,GAWzC,IAqEA,EArEiE,SAAHC,GAAsB,IAAhBC,EAAQD,EAARC,SAC9DC,EAAQ,EACZ,OACEC,EAAAA,EAAAA,KAACC,EAAAA,EAAa,CACZC,UAAU,gBACVC,cAAe,CAACC,EAAAA,EAAYC,EAAAA,GAC5BC,cAAe,CAACC,EAAAA,EAAaC,EAAAA,GAC7BC,WAAY,CACVC,KAAI,SAAAC,GAAOA,EAAJC,KAAgD,IAA1CC,EAAMF,EAANE,OAAQX,EAASS,EAATT,UAAWJ,EAAQa,EAARb,SAAagB,GAAKC,EAAAA,EAAAA,GAAAJ,EAAAK,GAC1CC,EAAQ,iBAAiBC,KAAKhB,GAAa,IAC3CiB,GAAUC,EAAAA,EAAAA,KAEVC,EAAc,WAElB,IAAMC,EAAeC,UAAUC,UACzBC,EAAQC,OAAO5B,GAAU6B,QAAQ,MAAO,IAC9CL,EAAaM,UAAUH,GAAOI,MAC5B,WACEV,EAAQW,QAAQ,6CAClB,IACA,WACEX,EAAQY,MAAM,2BAChB,GAEJ,EA4BA,OA1BAC,EAAAA,EAAAA,YAAU,WACR,IAAMC,EAAUC,SAASC,uBAAuB,8BAChD,GAAIF,EAAQlC,IAAUkB,EAAO,CAC3B,IAAMmB,EAASH,EAAQlC,GAAOsC,cAC9BD,EAAOE,MAAMC,SAAW,WAExB,IAAMC,EAAUN,SAASO,cAAc,OACvCD,EAAQtC,UAAY,sCACpBkC,EAAOM,sBAAsB,aAAcF,GAE3C,IAAMG,EAAMT,SAASO,cAAc,OACnCE,EAAIzC,UAAY,mCAChByC,EAAIC,UAAY3B,EAAM,GACtBuB,EAAQE,sBAAsB,aAAcC,GAE5C,IAAME,EAAUX,SAASO,cAAc,OACvCI,EAAQ3C,UAAY,uCACpB2C,EAAQD,UAAY,WACpBC,EAAQC,iBAAiB,QAASzB,GAClCmB,EAAQE,sBAAsB,aAAcG,GAC5C9C,GAAS,CACX,CACA,OAAO,WACLgD,oBAAoB,QAAS1B,EAC/B,CACF,GAAG,KACKR,GAAUI,GAChBjB,EAAAA,EAAAA,KAACP,EAAAA,GAAiBuD,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAKlC,GAAK,IAAEwB,MAAOW,EAAAA,EAAUC,SAAUjC,EAAM,GAAIf,UAAU,6BAA4BJ,SACtG4B,OAAO5B,GAAU6B,QAAQ,MAAO,QAGnC3B,EAAAA,EAAAA,KAAA,QAAAgD,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUlC,GAAK,IAAEZ,UAAWA,EAAUJ,SACnCA,IAGP,GACAA,SAEDA,GAGP,C,qLC/FA,EAA0B,4BAA1B,EAA8D,0BAA9D,EAAkG,4BAAlG,EAA0I,8BAA1I,EAAmL,6BAAnL,EAAyN,2BAAzN,EAAgQ,8B,oBCAhQ,EAA0B,gCAA1B,EAAmE,+B,8BCmCnE,EAtBuB,WACrB,IAAQqD,GAAYC,EAAAA,EAAAA,KAAe,SAAAC,GAAK,OAAIA,EAAMC,KAAKC,YAAY,IAA3DJ,QACFK,GAAWC,EAAAA,EAAAA,MACjB,OACEzD,EAAAA,EAAAA,KAAA,OAAKE,UAAS,GAAAwD,OAAKpB,EAAa,aAAYxC,UAC1CE,EAAAA,EAAAA,KAAA,OAAKE,UAAWoC,EAAaxC,UAC3BE,EAAAA,EAAAA,KAAC2D,EAAAA,GAAQ,CACPlC,MAAO0B,EACPS,QAAQ,OACRC,SAAU,SAAApC,GACR+B,GAASM,EAAAA,EAAAA,IAAWrC,GACtB,OAUV,E,kGC+OA,EArOmB,WACjB,IAAMsC,GAAQX,EAAAA,EAAAA,KAAe,SAAAC,GAAK,OAAIA,EAAMW,SAASC,QAAQ,IACvDC,GAAQC,EAAAA,EAAAA,KACRhD,GAAUC,EAAAA,EAAAA,KACVoC,GAAWC,EAAAA,EAAAA,MACTW,GAAUC,EAAAA,EAAAA,KAAVD,MAERE,GAA8ClB,EAAAA,EAAAA,KAAe,SAAAC,GAAK,OAAIA,EAAMC,KAAKC,YAAY,IAArFgB,EAAKD,EAALC,MAAOC,EAAMF,EAANE,OAAQrB,EAAOmB,EAAPnB,QAASsB,EAASH,EAATG,UAC1BC,GAAStB,EAAAA,EAAAA,KAAe,SAAAC,GAAK,OAAIA,EAAMC,KAAKoB,MAAM,IAClDC,GAAYvB,EAAAA,EAAAA,KAAe,SAAAC,GAAK,OAAIA,EAAMC,KAAKqB,SAAS,IACxDC,GAAaxB,EAAAA,EAAAA,KAAe,SAAAC,GAAK,OAAIA,EAAMW,SAASY,UAAU,IAC9DC,GAAQC,EAAAA,EAAAA,KACRC,GAAYC,EAAAA,EAAAA,IAAkBjB,EAAOc,GAAO,GAElDI,GAAkCC,EAAAA,EAAAA,WAAS,GAAMC,GAAAC,EAAAA,EAAAA,GAAAH,EAAA,GAA1CI,EAASF,EAAA,GAAEG,EAAYH,EAAA,GAG9BI,GAAwBL,EAAAA,EAAAA,WAAS,GAAMM,GAAAJ,EAAAA,EAAAA,GAAAG,EAAA,GAAhCE,GAAID,EAAA,GAAEE,GAAOF,EAAA,IACpBxD,EAAAA,EAAAA,YAAU,WAER,IAAMmB,EAAUjB,SAASyD,eAAe,+BAClCC,EAAQ1D,SAASyD,eAAe,6BACtCxC,EAAQb,MAAMuD,OAASC,OAAOC,YAAc,GAAK,KAC7CH,IACFA,EAAMtD,MAAMuD,OAASC,OAAOC,YAAc,GAAK,KAEnD,GAAG,CAAC3B,EAAO0B,OAAOC,eAElB/D,EAAAA,EAAAA,YAAU,WACRwB,GAASwC,EAAAA,EAAAA,GAAc,EAAC,GAAO,GAAO,GAAM,IAC9C,GAAG,IAEH,IAAMC,GAA4B,CAChC,CACEC,IAAK,IACLC,OAAOnG,EAAAA,EAAAA,KAAA,OAAKsC,MAAO,CAAE8D,SAAU,OAAQtG,SAAC,WACxCuG,QAAS,YACFC,EAAAA,EAAAA,IAAQvC,IAAWa,EAIxBV,EAAMqC,QAAQ,CACZhC,MAAO,eACPpB,QAAS,yJACTqD,KAAM,WACJhD,GAASiD,EAAAA,EAAAA,IAAa7B,KACtB8B,EAAAA,EAAAA,GAAW9B,GAAY/C,MACrB,SAAA8E,GACE,IAAMrD,EAAOqD,EAASC,KAAKtD,KACnBuD,EAAmCvD,EAAnCuD,cAAeC,EAAoBxD,EAApBwD,SAAUvC,EAAUjB,EAAViB,MAC3BwC,GAAOC,EAAAA,EAAAA,IAAgBjD,EAAO8C,GACpCrD,GACEyD,EAAAA,EAAAA,IAAc,CACZ1C,MAAAA,EACAC,OAAQuC,EAAKG,GACbzC,UAAWsC,EAAKxC,MAChBpB,SAASgE,EAAAA,EAAAA,IAASL,MAGtBtD,GAAS4D,EAAAA,EAAAA,KAAU,GACrB,IACA,SAAAC,GACElG,EAAQY,MAAMsF,EAAIlG,QACpB,GAEJ,IA3BAA,EAAQY,MAAM,qEA6BlB,GAEF,CACEmE,IAAK,IACLC,OAAOnG,EAAAA,EAAAA,KAAA,OAAKsC,MAAO,CAAE8D,SAAU,OAAQtG,SAAC,QACxCuG,QAAS,WACPnC,EAAMqC,QAAQ,CACZhC,MAAO,eACPpB,QAAS,uIACTqD,KAAM,WACJhD,GAAS8D,EAAAA,EAAAA,OACT9D,GAAS4D,EAAAA,EAAAA,KAAU,GACrB,GAEJ,IAGEG,GAAY,eAAA1H,GAAA2H,EAAAA,EAAAA,IAAAC,EAAAA,EAAAA,KAAAC,MAAG,SAAAC,IAAA,OAAAF,EAAAA,EAAAA,KAAAG,MAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,OACA,OAAnBzC,GAAa,GAAMuC,EAAAE,KAAA,GACbC,EAAAA,EAAAA,IACJ,CACEzD,MAAAA,EACAsC,cAAerC,EACfsC,SAAU3D,GACX,eAAAxC,GAAA6G,EAAAA,EAAAA,IAAAC,EAAAA,EAAAA,KAAAC,MACD,SAAAO,EAAMrB,GAAI,IAAAtD,EAAA,OAAAmE,EAAAA,EAAAA,KAAAG,MAAA,SAAAM,GAAA,cAAAA,EAAAJ,KAAAI,EAAAH,MAAA,cAAAG,EAAAH,KAAA,EACF5G,EAAQgH,oBAAoB,wBAAU,kCAAS,KAAD,EAC9C7E,EAAOsD,EAAKwB,SAEb9B,EAAAA,EAAAA,IAAQvC,IACXP,GAAS6E,EAAAA,EAAAA,IAAc/E,EAAK4D,KAG9B1D,GAAS8E,EAAAA,EAAAA,IAAYhF,IACrBE,GAAS8D,EAAAA,EAAAA,OACThC,GAAa,GAAO,wBAAA4C,EAAAK,OAAA,GAAAN,EAAA,KACrB,gBAAAO,GAAA,OAAA7H,EAAA8H,MAAA,KAAAC,UAAA,EAZA,IAaD,SAAAvF,GACEhC,EAAQY,MAAMoB,GACdmC,GAAa,EACf,IACA,KAAD,mBAAAuC,EAAAU,OAAA,GAAAZ,EAAA,KACF,kBAzBiB,OAAA9H,EAAA4I,MAAA,KAAAC,UAAA,KA2BZC,GAAY,eAAAC,GAAApB,EAAAA,EAAAA,IAAAC,EAAAA,EAAAA,KAAAC,MAAG,SAAAmB,IAAA,OAAApB,EAAAA,EAAAA,KAAAG,MAAA,SAAAkB,GAAA,cAAAA,EAAAhB,KAAAgB,EAAAf,MAAA,OACA,OAAnBzC,GAAa,GAAMwD,EAAAf,KAAA,GACbgB,EAAAA,EAAAA,IACJ,CACEC,OAAQrE,EACRiC,KAAM,CACJrC,MAAAA,EACAsC,cAAerC,EACfsC,SAAU3D,EACV8F,SAAUC,KAAKC,SAElB3B,EAAAA,EAAAA,IAAAC,EAAAA,EAAAA,KAAAC,MACD,SAAA0B,IAAA,OAAA3B,EAAAA,EAAAA,KAAAG,MAAA,SAAAyB,GAAA,cAAAA,EAAAvB,KAAAuB,EAAAtB,MAAA,cAAAsB,EAAAtB,KAAA,EACQ5G,EAAQgH,oBAAoB,wBAAU,kCAAS,KAAD,EACpD3E,GAAS8D,EAAAA,EAAAA,OACT9D,GACE8F,EAAAA,EAAAA,IAAa,CACXpC,GAAIvC,EACJJ,MAAAA,EACAsC,cAAerC,KAGnBhB,GAAS4D,EAAAA,EAAAA,KAAU,IACnB9B,GAAa,GAAO,wBAAA+D,EAAAd,OAAA,GAAAa,EAAA,MAEtB,SAAAjG,GACEhC,EAAQY,MAAMoB,GACdmC,GAAa,EACf,IACA,KAAD,mBAAAwD,EAAAP,OAAA,GAAAM,EAAA,KACF,kBA9BiB,OAAAD,EAAAH,MAAA,KAAAC,UAAA,KAgClB,OACEa,EAAAA,EAAAA,MAAA,OAAKrJ,UAAS,GAAAwD,OAAKpB,EAAa,aAAYxC,SAAA,EAC1CE,EAAAA,EAAAA,KAAA,OAAKkH,GAAG,4BAA4BhH,UAAWoC,EAAYxC,UACzDE,EAAAA,EAAAA,KAACwJ,EAAAA,EAAQ,CAACC,KAAK,cAEjBF,EAAAA,EAAAA,MAAA,OAAKrC,GAAG,8BAA8BhH,UAAWoC,EAAcxC,SAAA,EAC7DyJ,EAAAA,EAAAA,MAAA,OAAKrJ,UAAWoC,EAAgBxC,SAAA,CAAC,kCAE/BE,EAAAA,EAAAA,KAAC0J,EAAAA,EAAQ,CAAC3C,KAAM,CAAEd,MAAAA,GAAO0D,YAAY,EAAMC,aAAc,CAAClF,EAAS,IAAM,MAAO5E,UAC9EE,EAAAA,EAAAA,KAAA,KACEqG,QAAS,SAAAwD,GACPA,EAAEC,gBACJ,EAAEhK,UAEFyJ,EAAAA,EAAAA,MAACQ,EAAAA,EAAK,CAAAjK,SAAA,CACH4E,EAAS,SAAW,OACrB1E,EAAAA,EAAAA,KAACgK,EAAAA,EAAY,eAKrBT,EAAAA,EAAAA,MAAA,OAAKrJ,UAAWoC,EAAexC,SAAA,EAC7BE,EAAAA,EAAAA,KAACiK,EAAAA,EAAK,CACJC,WAAS,EACTC,YAAY,QACZC,UAAW,GACX9H,MAAO,CAAE8D,SAAU,OACnB3E,MAAO8C,EACPV,SAAU,SAAAgG,GACRrG,GAAS6G,EAAAA,EAAAA,IAASR,EAAES,OAAO7I,OAC7B,KAEFzB,EAAAA,EAAAA,KAACuK,EAAAA,EAAU,CACTC,UAAQ,EACRL,YAAY,iCACZM,UAAU,EACVC,SAAU3F,EACVtD,MAAOgD,QAAakG,EACpBC,sBAAoB,EACpB/G,SAAU,SAACqC,EAAK3B,GACdf,GAASqH,EAAAA,EAAAA,IAAU3E,IACnB1C,GAASsH,EAAAA,EAAAA,IAAavG,EAAM,IAC9B,QAGJvE,EAAAA,EAAAA,KAAA,OAAKE,UAAWoC,EAAaxC,UAC3BE,EAAAA,EAAAA,KAAC+K,EAAc,OAEjBxB,EAAAA,EAAAA,MAAA,OAAKrJ,UAAWoC,EAAgBxC,SAAA,CAE7B4E,GACC1E,EAAAA,EAAAA,KAACgL,EAAAA,GAAM,CAACC,KAAK,QAAQC,QAAS7F,EAAWgB,QAASsC,GAAa7I,SAAC,kBAIhEE,EAAAA,EAAAA,KAACgL,EAAAA,GAAM,CAACC,KAAK,QAAQC,QAAS7F,EAAWgB,QAASkB,GAAazH,SAAC,kBAIlEE,EAAAA,EAAAA,KAACgL,EAAAA,GAAM,CACLC,KAAK,QACL5E,QAAS,WACPX,IAAQ,EACV,EAAE5F,SACH,qBAIHE,EAAAA,EAAAA,KAACmL,EAAAA,EAAM,QAETnL,EAAAA,EAAAA,KAACoL,EAAAA,EAAM,CACLC,gBAAc,EACd9G,MAAM,eACN+G,UAAU,QACVlH,MAAOA,EAAQ,IAAM,OAAS,OAC9BmH,QAAS,WACP7F,IAAQ,EACV,EACAD,KAAMA,GAAK3F,UAEXE,EAAAA,EAAAA,KAACwL,EAAAA,EAAmB,CAAA1L,SAAEqD,QAI9B,C","sources":["components/ReactMarkdownRender/index.tsx","webpack://front-end/./src/pages/MainPage/BlogManage/index.module.scss?1349","webpack://front-end/./src/components/MarkdownEditor/index.module.scss?f01a","components/MarkdownEditor/index.tsx","pages/MainPage/BlogManage/index.tsx"],"sourcesContent":["import React, { useEffect } from 'react';\n\n// markdown\nimport ReactMarkdown from 'react-markdown';\nimport remarkMath from 'remark-math';\nimport rehypeKatex from 'rehype-katex';\nimport rehypeRaw from 'rehype-raw';\nimport remarkGfm from 'remark-gfm';\nimport { PrismLight as SyntaxHighlighter } from 'react-syntax-highlighter';\n// import { a11yDark } from 'react-syntax-highlighter/dist/esm/styles/prism';\n// import { coy } from 'react-syntax-highlighter/dist/esm/styles/prism';\nimport { oneLight } from 'react-syntax-highlighter/dist/esm/styles/prism';\nimport jsx from 'react-syntax-highlighter/dist/esm/languages/prism/jsx';\nimport tsx from 'react-syntax-highlighter/dist/esm/languages/prism/tsx';\nimport ts from 'react-syntax-highlighter/dist/esm/languages/prism/typescript';\n// 加入其他语言渲染\nSyntaxHighlighter.registerLanguage('jsx', jsx);\nSyntaxHighlighter.registerLanguage('tsx', tsx);\nSyntaxHighlighter.registerLanguage('ts', ts);\n\n// css\nimport 'github-markdown-css';\nimport './index.scss';\nimport { useGlobalMessage } from '@/components/ContextProvider/MessageProvider';\n\ninterface ReactMarkdownWrapperProps {\n  children: string;\n}\n\nconst ReactMarkdownRender: React.FC<ReactMarkdownWrapperProps> = ({ children }) => {\n  let count = 0;\n  return (\n    <ReactMarkdown\n      className=\"markdown-body\"\n      remarkPlugins={[remarkMath, remarkGfm]}\n      rehypePlugins={[rehypeKatex, rehypeRaw]}\n      components={{\n        code({ node, inline, className, children, ...props }) {\n          const match = /language-(\\w+)/.exec(className || '');\n          const message = useGlobalMessage();\n          // copy点击事件\n          const handleClick = () => {\n            // 复制到粘贴板\n            const clipboardObj = navigator.clipboard;\n            const value = String(children).replace(/\\n$/, '');\n            clipboardObj.writeText(value).then(\n              () => {\n                message.success('已粘贴到粘贴板');\n              },\n              () => {\n                message.error('粘贴失败');\n              }\n            );\n          };\n          // 这里利用原生js在代码块右上角插入一个代码所用语言的提示块和copy btn\n          useEffect(() => {\n            const codeBox = document.getElementsByClassName('syntax-highlighter-wrapper');\n            if (codeBox[count] && match) {\n              const parent = codeBox[count].parentElement as HTMLElement;\n              parent.style.position = 'relative';\n              // wrapper\n              const wrapper = document.createElement('div');\n              wrapper.className = 'syntax-highlighter-func-bar-wrapper';\n              parent.insertAdjacentElement('afterbegin', wrapper);\n              // code language\n              const div = document.createElement('div');\n              div.className = 'syntax-highlighter-code-language';\n              div.innerHTML = match[1];\n              wrapper.insertAdjacentElement('afterbegin', div);\n              // copy btn\n              const copyBtn = document.createElement('div');\n              copyBtn.className = 'iconfont syntax-highlighter-copy-btn';\n              copyBtn.innerHTML = '&#xe706;';\n              copyBtn.addEventListener('click', handleClick);\n              wrapper.insertAdjacentElement('afterbegin', copyBtn);\n              count += 1;\n            }\n            return () => {\n              removeEventListener('click', handleClick);\n            };\n          }, []);\n          return !inline && match ? (\n            <SyntaxHighlighter {...props} style={oneLight} language={match[1]} className=\"syntax-highlighter-wrapper\">\n              {String(children).replace(/\\n$/, '')}\n            </SyntaxHighlighter>\n          ) : (\n            <code {...props} className={className}>\n              {children}\n            </code>\n          );\n        },\n      }}\n    >\n      {children}\n    </ReactMarkdown>\n  );\n};\n\nexport default ReactMarkdownRender;\n","// extracted by mini-css-extract-plugin\nexport default {\"wrapper\":\"BlogManage_wrapper__d3LAd\",\"sider\":\"BlogManage_sider__ccAYg\",\"content\":\"BlogManage_content__cLxva\",\"editState\":\"BlogManage_editState__s0Q8E\",\"inputBox\":\"BlogManage_inputBox__5MrN2\",\"editor\":\"BlogManage_editor__PocT2\",\"submitBtn\":\"BlogManage_submitBtn__0KI33\",\"showAnime\":\"BlogManage_showAnime__vfysC\",\"anime\":\"BlogManage_anime__UMbeL\"};","// extracted by mini-css-extract-plugin\nexport default {\"wrapper\":\"MarkdownEditor_wrapper__fH2og\",\"editor\":\"MarkdownEditor_editor__dNZ27\",\"preview\":\"MarkdownEditor_preview__Iaqx9\",\"previewTips\":\"MarkdownEditor_previewTips__skJtm\",\"showAnime\":\"MarkdownEditor_showAnime__lCP0t\"};","import React from 'react';\nimport MDEditor from '@uiw/react-md-editor';\n\n// comp\n// import ReactMarkdownRender from '@/components/ReactMarkdownRender';\n\n// css\nimport style from './index.module.scss';\nimport './editor.scss';\n\n// redux\nimport { useAppDispatch, useAppSelector } from '@/redux';\nimport { setContent } from '@/redux/slices/blog';\n\nconst MarkdownEditor = () => {\n  const { content } = useAppSelector(state => state.blog.writeContent);\n  const dispatch = useAppDispatch();\n  return (\n    <div className={`${style.wrapper} clearfix`}>\n      <div className={style.editor}>\n        <MDEditor\n          value={content}\n          preview=\"edit\"\n          onChange={value => {\n            dispatch(setContent(value));\n          }}\n        />\n      </div>\n      {/* 预览字数多时会卡顿暂时不提供实时预览 */}\n      {/*<div className={style.preview}>*/}\n      {/*  <div className={style.previewTips}>预览</div>*/}\n      {/*  <ReactMarkdownRender>{preview}</ReactMarkdownRender>*/}\n      {/*</div>*/}\n    </div>\n  );\n};\nexport default MarkdownEditor;\n","import React, { useEffect, useState } from 'react';\n\n// antd\nimport { Input, TreeSelect, Button, Drawer, Dropdown, Space } from 'antd';\nimport { DownOutlined } from '@ant-design/icons';\nimport type { MenuProps } from 'antd';\n\n// css\nimport style from './index.module.scss';\n\n// comp\nimport SideMenu from '@/components/SideMenu';\nimport MarkdownEditor from '@/components/MarkdownEditor';\nimport ReactMarkdownRender from '@/components/ReactMarkdownRender';\nimport Footer from '@/components/Footer';\n\n// utils\nimport { filterLT, getSideMenuItem, getTreeSelectList, hasBlog } from '@/utils';\n\n// redux\nimport { useAppDispatch, useAppSelector } from '@/redux';\nimport { addBlogMenu, setSelectedId, editBlogMenu } from '@/redux/slices/blogMenu';\nimport { setChosenList } from '@/redux/slices/chosenList';\nimport {\n  setMenuId,\n  setTitle,\n  setMenuTitle,\n  initWriteContent,\n  setIsEdit,\n  setAllContent,\n  setCurEditId,\n} from '@/redux/slices/blog';\n\n// context\nimport { useIcons } from '@/components/ContextProvider/IconStore';\nimport { useGlobalMessage } from '@/components/ContextProvider/MessageProvider';\nimport { useGlobalModal } from '@/components/ContextProvider/ModalProvider';\nimport { useViewport } from '@/components/ContextProvider/ViewportProvider';\n\n// api\nimport { addBlogAjax, getCurBlog, updateBlogAjax } from '@/api/blog';\n\n// interface\nimport { SideMenuItem } from '@/interface';\n\nconst BlogManage = () => {\n  const menus = useAppSelector(state => state.blogMenu.menuList);\n  const modal = useGlobalModal();\n  const message = useGlobalMessage();\n  const dispatch = useAppDispatch();\n  const { width } = useViewport();\n  // text info\n  const { title, menuId, content, menuTitle } = useAppSelector(state => state.blog.writeContent);\n  const isEdit = useAppSelector(state => state.blog.isEdit);\n  const curEditId = useAppSelector(state => state.blog.curEditId);\n  const selectedId = useAppSelector(state => state.blogMenu.selectedId);\n  const icons = useIcons();\n  const antdMenus = getTreeSelectList(menus, icons, true);\n  // 提交按钮loading状态\n  const [isLoading, setIsLoading] = useState(false);\n  // 当前正在编辑的id，如果不用的话，编辑中选择其他博客selectedId会改变，修改的博客就变成了其他博客了\n  // 预览打开state\n  const [open, setOpen] = useState(false);\n  useEffect(() => {\n    // 初始化设置content和sider高度为视窗高度-TopHeader高度（为了设置滚动，且缩放时能看到全貌）\n    const content = document.getElementById('blog-manage-content-wrapper') as HTMLElement;\n    const sider = document.getElementById('blog-manage-sider-wrapper') as HTMLElement;\n    content.style.height = window.innerHeight - 50 + 'px';\n    if (sider) {\n      sider.style.height = window.innerHeight - 50 + 'px';\n    }\n  }, [width, window.innerHeight]);\n\n  useEffect(() => {\n    dispatch(setChosenList([false, false, true, false]));\n  }, []);\n  // 编辑状态菜单\n  const items: MenuProps['items'] = [\n    {\n      key: '1',\n      label: <div style={{ fontSize: '1vw' }}>Update</div>,\n      onClick: () => {\n        if (!hasBlog(menus) && !selectedId) {\n          message.error('当前没有博客可供编辑！');\n          return;\n        }\n        modal.confirm({\n          title: '提示',\n          content: '编辑当前博客会覆盖正在编辑的内容，确定要这么做吗？',\n          onOk: () => {\n            dispatch(setCurEditId(selectedId));\n            getCurBlog(selectedId).then(\n              response => {\n                const blog = response.data.blog;\n                const { belongingMenu, contents, title } = blog;\n                const menu = getSideMenuItem(menus, belongingMenu) as SideMenuItem;\n                dispatch(\n                  setAllContent({\n                    title,\n                    menuId: menu.id,\n                    menuTitle: menu.title,\n                    content: filterLT(contents),\n                  })\n                );\n                dispatch(setIsEdit(true));\n              },\n              err => {\n                message.error(err.message);\n              }\n            );\n          },\n        });\n      },\n    },\n    {\n      key: '2',\n      label: <div style={{ fontSize: '1vw' }}>Add</div>,\n      onClick: () => {\n        modal.confirm({\n          title: '提示',\n          content: '添加博客会情况当前编辑状态，确定要这么做吗？',\n          onOk: () => {\n            dispatch(initWriteContent());\n            dispatch(setIsEdit(false));\n          },\n        });\n      },\n    },\n  ];\n  const handleSubmit = async () => {\n    setIsLoading(true);\n    await addBlogAjax(\n      {\n        title,\n        belongingMenu: menuId,\n        contents: content,\n      },\n      async data => {\n        await message.loadingSuccessAsync('提交中...', '提交成功！');\n        const blog = data.newBlog;\n        // 如果当前没有blog，则创建完毕后默认选中该blog\n        if (!hasBlog(menus)) {\n          dispatch(setSelectedId(blog.id));\n        }\n        // 更新主页博客信息\n        dispatch(addBlogMenu(blog as SideMenuItem));\n        dispatch(initWriteContent());\n        setIsLoading(false);\n      },\n      content => {\n        message.error(content);\n        setIsLoading(false);\n      }\n    );\n  };\n\n  const handleUpdate = async () => {\n    setIsLoading(true);\n    await updateBlogAjax(\n      {\n        blogId: curEditId,\n        data: {\n          title,\n          belongingMenu: menuId,\n          contents: content,\n          updateAt: Date.now(),\n        },\n      },\n      async () => {\n        await message.loadingSuccessAsync('更新中...', '更新成功！');\n        dispatch(initWriteContent());\n        dispatch(\n          editBlogMenu({\n            id: curEditId,\n            title,\n            belongingMenu: menuId,\n          })\n        );\n        dispatch(setIsEdit(false));\n        setIsLoading(false);\n      },\n      content => {\n        message.error(content);\n        setIsLoading(false);\n      }\n    );\n  };\n\n  return (\n    <div className={`${style.wrapper} clearfix`}>\n      <div id=\"blog-manage-sider-wrapper\" className={style.sider}>\n        <SideMenu page=\"manage\"></SideMenu>\n      </div>\n      <div id=\"blog-manage-content-wrapper\" className={style.content}>\n        <div className={style.editState}>\n          当前状态：\n          <Dropdown menu={{ items, selectable: true, selectedKeys: [isEdit ? '1' : '2'] }}>\n            <a\n              onClick={e => {\n                e.preventDefault();\n              }}\n            >\n              <Space>\n                {isEdit ? 'Update' : 'Add'}\n                <DownOutlined />\n              </Space>\n            </a>\n          </Dropdown>\n        </div>\n        <div className={style.inputBox}>\n          <Input\n            showCount\n            placeholder=\"Title\"\n            maxLength={50}\n            style={{ fontSize: '2vw' }}\n            value={title}\n            onChange={e => {\n              dispatch(setTitle(e.target.value));\n            }}\n          />\n          <TreeSelect\n            treeIcon\n            placeholder=\"请选择分类\"\n            treeLine={true}\n            treeData={antdMenus}\n            value={menuTitle || undefined}\n            treeDefaultExpandAll\n            onChange={(key, title) => {\n              dispatch(setMenuId(key));\n              dispatch(setMenuTitle(title[0]));\n            }}\n          />\n        </div>\n        <div className={style.editor}>\n          <MarkdownEditor></MarkdownEditor>\n        </div>\n        <div className={style.submitBtn}>\n          {/* 是否处于编辑状态 */}\n          {isEdit ? (\n            <Button size=\"large\" loading={isLoading} onClick={handleUpdate}>\n              更新\n            </Button>\n          ) : (\n            <Button size=\"large\" loading={isLoading} onClick={handleSubmit}>\n              提交\n            </Button>\n          )}\n          <Button\n            size=\"large\"\n            onClick={() => {\n              setOpen(true);\n            }}\n          >\n            预览\n          </Button>\n        </div>\n        <Footer></Footer>\n      </div>\n      <Drawer\n        destroyOnClose\n        title=\"总览\"\n        placement=\"right\"\n        width={width > 768 ? '50vw' : '75vw'}\n        onClose={() => {\n          setOpen(false);\n        }}\n        open={open}\n      >\n        <ReactMarkdownRender>{content}</ReactMarkdownRender>\n      </Drawer>\n    </div>\n  );\n};\n\nexport default BlogManage;\n"],"names":["SyntaxHighlighter","jsx","tsx","ts","_ref","children","count","_jsx","ReactMarkdown","className","remarkPlugins","remarkMath","remarkGfm","rehypePlugins","rehypeKatex","rehypeRaw","components","code","_ref2","node","inline","props","_objectWithoutProperties","_excluded","match","exec","message","useGlobalMessage","handleClick","clipboardObj","navigator","clipboard","value","String","replace","writeText","then","success","error","useEffect","codeBox","document","getElementsByClassName","parent","parentElement","style","position","wrapper","createElement","insertAdjacentElement","div","innerHTML","copyBtn","addEventListener","removeEventListener","_objectSpread","oneLight","language","content","useAppSelector","state","blog","writeContent","dispatch","useAppDispatch","concat","MDEditor","preview","onChange","setContent","menus","blogMenu","menuList","modal","useGlobalModal","width","useViewport","_useAppSelector","title","menuId","menuTitle","isEdit","curEditId","selectedId","icons","useIcons","antdMenus","getTreeSelectList","_useState","useState","_useState2","_slicedToArray","isLoading","setIsLoading","_useState3","_useState4","open","setOpen","getElementById","sider","height","window","innerHeight","setChosenList","items","key","label","fontSize","onClick","hasBlog","confirm","onOk","setCurEditId","getCurBlog","response","data","belongingMenu","contents","menu","getSideMenuItem","setAllContent","id","filterLT","setIsEdit","err","initWriteContent","handleSubmit","_asyncToGenerator","_regeneratorRuntime","mark","_callee2","wrap","_context2","prev","next","addBlogAjax","_callee","_context","loadingSuccessAsync","newBlog","setSelectedId","addBlogMenu","stop","_x","apply","arguments","handleUpdate","_ref3","_callee4","_context4","updateBlogAjax","blogId","updateAt","Date","now","_callee3","_context3","editBlogMenu","_jsxs","SideMenu","page","Dropdown","selectable","selectedKeys","e","preventDefault","Space","DownOutlined","Input","showCount","placeholder","maxLength","setTitle","target","TreeSelect","treeIcon","treeLine","treeData","undefined","treeDefaultExpandAll","setMenuId","setMenuTitle","MarkdownEditor","Button","size","loading","Footer","Drawer","destroyOnClose","placement","onClose","ReactMarkdownRender"],"sourceRoot":""}